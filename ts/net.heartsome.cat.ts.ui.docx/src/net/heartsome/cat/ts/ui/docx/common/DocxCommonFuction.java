package net.heartsome.cat.ts.ui.docx.common;import org.eclipse.core.runtime.IProgressMonitor;import org.eclipse.core.runtime.OperationCanceledException;/** * 导入导出　docx 文档的公用方法 * @author robert	2013-05-10 */public class DocxCommonFuction {	public DocxCommonFuction(){ }			/**	 * 根据一个标记字符串，判断这个标记是什么类型	 * @param tagText	 * @return	 */	public static int getTagType(String tagText){		int tagType = -1;		if (tagText.indexOf("/>") != -1 || (tagText.indexOf("<ph") != -1 && tagText.indexOf("</ph") != -1)) {			tagType = DocxConstant.NOTPAIR;		}else if (tagText.indexOf("</") != -1) {			tagType = DocxConstant.PAIREND;		}else {			tagType = DocxConstant.PAIRSTAR;		}		return tagType;	}		public static void monitorWork(IProgressMonitor monitor, int traversalTuIndex, int workInterval, boolean last) throws Exception{		if (last) {			if (traversalTuIndex % workInterval != 0) {//				try {//					Thread.sleep(500);//				} catch (Exception e) {//				}				if (monitor.isCanceled()) {					throw new OperationCanceledException();				}				monitor.worked(1);			}		}else {			if (traversalTuIndex % workInterval == 0) {//				try {//					Thread.sleep(500);//				} catch (Exception e) {//				}				if (monitor.isCanceled()) {					throw new OperationCanceledException();				}				monitor.worked(1);			}		}	}	}